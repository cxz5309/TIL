# NEXT.js
- React의 SSR(Server Side Rendering)을 쉽게 구현할 수 있게 도와주는 간단한 프레임워크

## Next.js 등장 배경
- <a href='../../JS/CSR과 SSR/README.MD#csr'>CSR</a>방식의 React만으로 애플리케이션을 구성하는 데에는 아래와 같은 문제가 있을 수 있다.  
> - 자바스크립트 코드를 번들링 하기 위해 webpack 등의 모듈 번들러를 사용하지만, 그렇게 생성된 자바스크립트 번들은 용량이 크고 그만큼의 로딩 시간이 든다. 최적화를 위해서는 코드 스플리팅 처리가 필요하다.  
> - SEO를 고려하기 위해 자바스크립트 소스를 렌더링하기 전에 정적 소스를 먼저 불러와야 할 경우가 있을 수 있다.  
> - React를 사용하는 경우 SSR 처리가 어렵다.  

- Next.js는 클라이언트 사이드 렌더링에서 발생하는 여러 문제들을 해결하고, React에서 SSR을 구현할 수 있게 해 준다. 
- 이는 서버사이드 렌더링과 클라이언트 사이드 렌더링을 적절히 조합한 것으로 두 방식의 장점을 모두 가진다. 
- 첫 접속은 서버사이드 렌더링으로 이뤄지되, 그 이후에는 클라이언트 사이드 렌더링을 사용하는 것이다.
> 따라서 Next.js는 SSR과 CSR의 단점을 모두 보완한 프레임워크로 그 단점에 반대되는 장점을 가진다.
> - 첫 접속 시, 필요한 페이지의 내용만 받기 때문에 로딩이 빠르다.
> - 검색엔진에 검색되기 용이하다.
> - 페이지 이동이 빠르다.
> - 전체적으로 개별적인 상황에 맞춰 데이터를 수신하기 때문에 속도가 빠르다.

## Next.js의 특징
1. pre-rendering
   - Next.js는 렌더링 서버를 자체적으로 지원하고, 기본적으로 모든 페이지를 프리 렌더링한다. 클라이언트 사이드에서 모든 작업을 수행하는 대신 미리 각 페이지에 대해서 HTML 파일을 미리 만들어 성능과 SEO 측면에서 도움을 준다.
   - Next.js는 최소한의 자바스크립트 코드를 사용해 HTML 화면을 먼저 생성한다. 그리고 이어 자바스크립트가 로드되면, 그때 컴포넌트와 앱 화면이 완전히 활성화된다. 이러한 과정을 hydration이라고 한다.
     - ### Hybrid - SSG and SSR
     - Next.js는 두 가지 형태의 프리 렌더링을 지원한다. 정적 생성(Static Generation)과 서버 사이드 렌더링(SSR)이다. Next.js에서는 성능상의 이유로 SSG를 추천하고 있지만, 각 페이지마다 어떤 종류를 택할지 선택할 수 있다.
       - Static Generation: 빌드 시점에 HTML 파일이 생성되며, 매 요청마다 재사용된다. CDN으로 캐싱되어 사용할 수 있다. 마케팅 이벤트 페이지나 documentation 등, request를 받기 전에 그릴 수 있는 정적 페이지에 사용된다.
       - Server Side Rendering: HTML이 request에 따라 생성된다. 최신화된 데이터를 사용하거나 사용자 요청에 따라 데이터를 받아와야 하는 페이지에서 사용된다.
2. data fetching
   - Next.js에서는 프리 렌더링 단계에서의 data fetching을 위해 아래 세 함수를 지원한다.
   > 1. getStaticProps : 빌드 타임에 데이터 요청
   > 2. getServerSideProps : 매 요청에 따라 데이터 요청
   > 3. getStaticPaths : 요청된 데이터에 의한 다이나믹 라우팅을 명시
3. File system Routes / Dynamic Routes
   - Next.js에서 라우팅 처리되는 컴포넌트들은 최상위에 있는 pages라는 폴더 안에 위치한다.
   - 라우팅은 기본적으로 해당 페이지의 디렉토리 경로에 맞게 호출된다. 만약 라우트가 /authors/me라면, pages/authors 폴더 안에 me.js 파일이 있어야 한다.
   - 동적 라우팅도 사용 가능하다. 변수 파라미터를 표시하기 위해 브라켓 파라메터를 사용한다.

4. Image Optimization
   - next 10.0 버전 이후부터는 html의 `<img>` 태그를 확장한 next/image라는 컴포넌트를 사용할 수 있다. 
   - next/image는 이미지 최적화 기능을 내장하고 있어 리사이징, 옵티마이징, 그리고 WebP와 같은 최신 포맷이 사용 가능한 브라우저에서는 이러한 포맷으로 이미지를 제공한다. 
   - 이미지 옵티마이징을 할 때 빌드되는 시점이 아니라 사용자에 의해 리소스가 요청되는 시점에 실행하기 때문에, 이미지가 많다고 해도 최적화에 따른 빌드 타임이 증가하지 않는다. 
   - 또한 레이지 로딩 기능도 내장하고 있어, viewport 바깥 영역에 있는 이미지들은 스크롤로 화면에 표시될 때만 로드된다.