# SQL vs NOSQL

> 그냥 간단하게 sql은 수정이 어렵지만 정확하니 큰데서 쓰고 nosql은 작은데서 쓰는 정도만 알고 있었다. 자세히 알아보자.  

- 가장 기본적인 수준에서 이 두 기술의 가장 큰 차이점은 SQL 데이터베이스는 관계형이고 NoSQL 데이터베이스는 비관계형이라는 것이다.

## SQL (관계형 DB)
> MySQL, Oracle, PostgreSQL
- RDB(Relational Databas) 라고도 한다. (사실 이게 더 맞는데 NOSQL과의 차이를 위해 SQL이라고 부른다.)
- 관계형 데이터베이스에는 핵심적인 두 가지 특징이 있다.
1. 데이터는 정해진 데이터 스키마에 따라 테이블에 저장된다.
2. 데이터는 관계를 통해 여러 테이블에 분산된다.
- 데이터는 테이블에 레코드로 저장되는데, 각 테이블마다 명확하게 정의된 구조가 있다. 해당 구조는 필드의 이름과 데이터 유형으로 정의된다.
- 따라서 **스키마를 준수하지 않은 레코드는 테이블에 추가할 수 없다**. 즉, 스키마를 수정하지 않는 이상은 정해진 구조에 맞는 레코드만 추가가 가능한 것이 관계형 데이터베이스의 특징 중 하나다.
![관계형](https://res.cloudinary.com/academind-gmbh/image/upload/f_auto,q_auto:eco/dpr_2.0,w_400,c_limit,g_center/v1/academind.com/content/tutorials/sql-vs-nosql/sql-schema)   
- 또한, 데이터의 중복을 피하기 위해 '관계'를 이용한다.
- 하나의 테이블에서 중복 없이 하나의 데이터만을 관리하기 때문에 다른 테이블에서 부정확한 데이터를 다룰 위험이 없어지는 장점이 있다.
![관계형](https://res.cloudinary.com/academind-gmbh/image/upload/f_auto,q_auto:eco/dpr_2.0,w_400,c_limit,g_center/v1/academind.com/content/tutorials/sql-vs-nosql/sql-relations)

## NoSQL (비관계형 DB)
> MongoDB, Redis
- 스키마도 없고, 관계도 없다. 이것이 이 둘의 핵심적인 차이점이다.

- ### 그로 인해 발생하는 일을 알아보자

  - 스키마가 없다.
    - 가장 큰 특징이자 장점으로 SQL은 정해진 스키마를 따르지 않으면 데이터 추가가 불가능하지만 NoSQL에서는 다른 구조의 데이터를 같은 컬렉션에 추가가 가능하다. 
    - 즉, 스키마를 정의하지 않아도 되기 때문에 데이터베이스의 수정이 간편하다!
    - 이것은 수정이 잦거나 데이터가 엄격하지 않아도 되는 작은 규모의 프로젝트에 어울린다고 볼 수 있다.
![비관계형](https://res.cloudinary.com/academind-gmbh/image/upload/f_auto,q_auto:eco/dpr_2.0,w_400,c_limit,g_center/v1/academind.com/content/tutorials/sql-vs-nosql/nosql-no-schema)  

  -관계가 없다.
    - 관계가 없기 때문에 조인하고 싶을 때 해결 방법으로 보통 컬렉션을 통해 데이터를 복제하여 각 컬렉션 일부분에 속하는 데이터를 산출하여 넣어주거나 관계를 새로 만들어주는 작업을 해야 한다.
    - 이런 방식은 데이터가 중복되기 때문에 불안정한 측면이 있다. 실수로 컬렉션 B에서는 데이터를 수정하지 않았는데, 컬렉션 A에서만 데이터를 업데이트 할 위험이 있다. 
    - 또한 특정 데이터를 같이 사용하는 모든 컬렉션에서, 똑같은 데이터 업데이트를 수행되도록 해야 한다.
    - 그럼에도 불구하고, 조인은 복잡하고 어떤 순간에는 느리기 때문에 특히 자주 변경되지 않는 데이터 일때 유용하지 못하다.
    - 따라서 조인을 잘 사용하지 않고 자주 변경되지 않는 데이터일 때 NoSQL을 쓰면 상당히 효율적이다.
![비관계형](https://res.cloudinary.com/academind-gmbh/image/upload/f_auto,q_auto:eco/dpr_2.0,w_400,c_limit,g_center/v1/academind.com/content/tutorials/sql-vs-nosql/nosql-no-relations)


## 수직적(Vertical) & 수평적(Horizontal) 확장(Scaling)
- 두 종류의 데이터베이스를 비교 할 때 살펴 봐야할 또 하나의 중요한 개념은 확장이다.
- 수직적 확장이란 단순히 데이터베이스 서버의 성능을 향상시키는 것이다. (예를 들어, CPU를 업그레이드 하는 방식)
- 반면에 수평적 확장은 더 많은 서버가 추가되고 데이터베이스가 전체적으로 분산됨을 의미한다. 따라서 하나의 데이터베이스에서 작동하지만 여러 호스트에서 작동한다.
![차이](https://t1.daumcdn.net/cfile/tistory/990D6E385C937F8530)
- 데이터가 저장되는 방식 때문에 SQL 데이터베이스는 일반적으로 수직적 확장만을 지원한다. 수평적 확장은 NoSQL 데이터베이스에서만 가능하다.

## 올바른 선택

- 두 가지 중 하나의 솔루션을 선택해야 되는 문제에서는 어떤 데이터를 다루는지, 어떤 애플리케이션에서 사용되는지 고려해야한다. 
### 장단점
#### SQL의 장점
- 명확하게 정의 된 스키마, 데이터 무결성 보장
- 관계는 각 데이터를 중복없이 한번만 저장
#### NoSQL의 장점
- 스키마가 없기때문에, 훨씬 더 유연합니다. 즉, 언제든지 저장된 데이터를 조정하고 새로운 "필드"를 추가 할 수 있다.
- 데이터는 애플리케이션이 필요로 하는 형식으로 저장됩니다. 이렇게 하면 데이터를 읽어오는 속도가 빨라진다.
- 수직 및 수평 확장이 가능하므로 데이터베이스가 애플리케이션에서 발생시키는 모든 읽기 / 쓰기 요청을 처리 할 수 있다.
#### SQL의 단점
- 상대적으로 덜 유연합니다. 데이터 스키마는 사전에 계획되고 알려져야 합니다. (나중에 수정하기가 번거롭거나 불가능 할 수 도 있다.)
- 관계를 맺고 있기 때문에, JOIN문이 많은 매우 복잡한 쿼리가 만들어 질 수 있다.
- 수평적 확장이 어렵고, 대체로 수직적 확장만 가능합니다. 즉 어떤 시점에서 (처리 할 수 있는 처리량과 관련하여) 성장 한계에 직면하게 된다.
#### NoSQL의 단점
- 유연성 때문에, 데이터 구조 결정을 하지 못하고 미루게 될 수 있다.
- 데이터 중복은 여러 컬렉션과 문서가 (SQL 세계에서 처럼 하나의 테이블에 하나의 레코드가 아니라) 여러 개의 레코드가 변경된 경우 업데이트를 해야 합니다.
- 데이터가 여러 컬렉션에 중복되어 있기 때문에, 수정(update)를 해야 하는 경우 모든 컬렉션에서 수행해야 함을 의미한다. (SQL 세계에서는 중복된 데이터가 없기 때문에 한번만 수행하면 된다.)

> SQL 데이터베이스는 '샤딩(Sharding)'의 개념을 알고 있지만 특정 제한이 있으며 구현하기가 대체로 어렵다.   
> NoSQL 데이터베이스는 이를 기본적으로 지원하므로 여러 서버에서 데이터베이스를 쉽게 분리 할 수 있다.  
> - 샤딩 : Sharding(샤딩)은 같은 테이블 스키마를 가진 데이터를 다수의 DB에 분산하여 저장하는 방법이다.
> https://sophia2730.tistory.com/entry/Databases-Database-Sharding%EC%83%A4%EB%94%A9

### 선택
#### SQL을 사용하는 경우
- 관계를 맺고 있는 데이터가 자주 변경(수정)되는 애플리케이션일 경우 (NoSQL에서라면 여러 컬렉션을 모두 수정해줘야만 한다.)
- 변경될 여지가 없고, 명확한 스키마가 사용자와 데이터에게 중요한 경우
#### NoSQL을 사용하는 경우
- 정확한 데이터 구조를 알 수 없거나 변경 / 확장 될 수 있는 경우
- 읽기(read)처리를 자주하지만, 데이터를 자주 변경(update)하지 않는 경우 (즉, 한번의 변경으로 수십 개의 문서를 업데이트 할 필요가 없는 경우)
- 데이터베이스를 수평으로 확장해야 하는 경우 ( 즉, 막대한 양의 데이터를 다뤄야 하는 경우)
> 분명한 것은 데이터베이스는 다른 방식으로 설계 될 수 있다는 것이다.   
> NoSQL 데이터베이스를 쓰더라도 설계적으로 언급된 단점들을 완화시킬 수 있다. SQL 데이터베이스도 마찬가지다. 요구사항을 만족시키고, 복잡한 JOIN문을 만들지 않도록 설계할 수 있다. 
> 또한 어떤 하나의 DB 형태만 적용하는 것이 아니라 2가지를 혼합해서 사용하는 경우도 많다고 한다.

<br/>

> 출처:
> https://gyoogle.dev/blog/computer-science/data-base/SQL%20&%20NOSQL.html  
> https://siyoon210.tistory.com/130  
> https://velog.io/@thms200/SQL-vs-NoSQL  
> 사실 거의 다 여기 내용을 번역한 것이 대부분이었다.  
> https://academind.com/tutorials/sql-vs-nosql  