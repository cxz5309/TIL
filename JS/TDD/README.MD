# TDD(Test Driven Development)
테스트 주도 개발: 테스트가 개발을 이끌어 나간다.

## 행동 레벨에서의 TDD의 개념

- 테스트를 먼저 만들고 테스트를 통과하기 위한 것을 짜는 것 즉, 만드는 과정에서 우선 테스트를 작성하고 그걸 통과하는 코드를 만들고를 반복하면서 제대로 동작하는지에 대한 피드백을 적극적으로 받는 것이다.

## 개념 레벨에서의 TDD의 개념
테스트를 먼저 만들고 테스트를 통과하기 위한 것을 짜는 

- 결정과 피드백 사이의 갭에 대한 인식, 더 나아가 결정과 피드백 사이의 갭을 조절하기 위한 테크닉이라고도 할 수 있다.
> TDD란?  
> - 결정과 피드백 사이의 갭에 대한 인식  
> - 결정과 피드백 사이의 갭을 조절하기 위한 테크닉  
> TDD는 프로그래밍 기법이나 기술적인 느낌보다는 심리적인 것으로 볼 수 있다  
> : 켄트 벡(Kent Beck, 익스트림 프로그래밍의 창시자)
- 결정 : 프로그램을 하다보면 ‘이 방법으로 해야지’, ‘이 부분은 이걸 이용해서 짜야지’라는 것을 결정한다.
- 피드백 : 프로그램을 하다보면 성공/실패(에러)라는 피드백을 받는다.
- 이 둘(결정과 피드백) 사이에 갭이 생긴다.
- 이 갭이 커질수록 문제가 되고 내가 그 갭을 모르면 더 큰 문제가 생긴다.

## TDD 개발 주기
[image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FmG0Pb%2FbtqBZMj04hL%2FiFrPHyeudxXYfxkWANylY0%2Fimg.png)  
- <Red>단계에서는 실패하는 테스트 코드를 먼저 작성한다. 
- <Green>단계에서는 테스트 코드를 성공시키기 위한 실제 코드를 작성한다. 
- <Yellow>단계에서는 중복 코드 제거, 일반화 등의 리팩토링을 수행한다. 

## TDD의 효과
모든 애자일의 실천법은 피드백과 협력을 동시에 증진시킨다.

1. 피드백
   - TDD를 하면 피드백이 증가한다.
   - 테스트를 통과하는 것으로 잘되고 있는가를 자주 확인할 수 있다.
2. 협력
   - ‘test’는 일반적으로 동사로 사용한다. ‘테스트한다.’, ‘테스트해라.’
   - 예를 들어, 누가 나한테 생년월일(input)을 입력받으면 현재 나이(output)를 출력하는 프로그램을 주고 test해보라고 한다면 내가 할 수 있는 것은 숫자를 여러 개 찍어보는 것이다.
   - 그러나 TDD를 하면 ‘test’는 명사가 된다.
   - 동사는 그 순간에만 하는 것이고, 명사(대상, 목적어)는 이후에도 소유할 수가 있다. 즉, record로 남을 수 있다.
   - ‘test’가 저장된다는 것은 남들에게 남들에게 테스트 코드를 보여줄 수 있고, 남들은 그 코드를 직접 실행해볼 수 있다는 것이다.
### 그렇다면 TDD는 왜 협력을 증진시키는가?
- ‘test’가 명사(대상, 목적어)가 되는 순간 이것을 공유하기가 쉬워진다.
  - 공유하면 협력이 증진된다.
  - 남이 짠 코드를 빨리 이해할 수 있다.
  - 남이 짠 코드를 쉽게 이해할 수 있다.
  - 용기가 생긴다.(내가 남의 코드를 고쳐서 문제가 있더라도 자동화된 테스트가 알려주기 때문에 큰 걱정없이 고칠 수 있는 용기가 생긴다.)
- 즉, 왜 이렇게 짰을까 궁금할 때 ‘test’를 공유하고 그 테스트 코드를 보면 이해할 수 있다.
- 테스트 코드에는 개발자의 개발 과정(어떤 고민/어떤 의사결정)이 나와있기 때문이다.
- 앞의 TDD의 정의(결정(decision)과 피드백(feedback) 사이의 갭을 인식하는 것)와 같이 테스트 코드(feedback)를 보면 그 사람의 의사결정(decision)이 나타나고 상대방은 그 부분은 왜 그렇게 짰는지를 쉽고 빨리 알게 되기 때문에 협력이 증진된다.

## TDD의 장단점
### TDD의 장점
1. 보다 튼튼한 객체 지향적인 코드 생산
   - TDD는 코드의 재사용 보장을 명시하므로 TDD를 통한 소프트웨어 개발 시 기능 별 철저한 모듈화가 이뤄진다. 이는 종속성과 의존성이 낮은 모듈로 조합된 소프트웨어 개발을 가능하게 하며 필요에 따라 모듈을 추가하거나 제거해도 소프트웨어 전체 구조에 영향을 미치지 않게 된다.
2. 재설계 시간의 단축 
   - 테스트 코드를 먼저 작성하기 때문에 개발자가 지금 무엇을 해야하는지 분명히 정의하고 개발을 시작하게 된다. 또한 테스트 시나리오를 작성하면서 다양한 예외사항에 대해 생각해볼 수 있다. 이는 개발 진행 중 소프트웨어의 전반적인 설계가 변경되는 일을 방지할 수 있다.
3. 디버깅 시간의 단축
   - 이는 유닛 테스팅을 하는 이점이기도 하다. 예를 들면 사용자의 데이터가 잘못 나온다면 DB의 문제인지, 비즈니스 레이어의 문제인지 UI의 문제인지 실제 모든 레이러들을 전부 디버깅 해야하지만, TDD의 경우 자동화 된 유닛테스팅을 전재하므로 특정 버그를 손 쉽게 찾아낼 수 있다. 

4. 테스트 문서의 대체 가능 
   - 주로 SI 프로젝트 진행 과정에서 어떤 요소들이 테스트 되었는지 테스트 정의서를 만든다. 이것은 단순 통합 테스트 문서에 지나지 않는다. 하지만 TDD를 하게 될 경우 테스팅을 자동화 시킴과 동시에 보다 정확한 테스트 근거를 산출할 수 있다.

5. 추가 구현의 용이함
   - 개발이 완료된 소프트웨어에 어떤 기능을 추가할 때 가장 우려되는 점은 해당 기능이 기존 코드에 어떤 영향을 미칠지 알지 못한다는 것이다. 하지만 TDD의 경우 자동화된 유닛 테스팅을 전제하므로 테스트 기간을 획기적으로 단축시킬 수 있다.
### TDD의 단점
1. 생산성의 저하
   - 개발 속도가 느려진다고 생각하는 사람이 많기 때문에 TDD에 대해 반신반의 한다. 왜냐하면 처음부터 2개의 코드를 짜야하고, 중간중간 테스트를 하면서 고쳐나가야 하기 때문이다.
   - TDD 방식의 개발 시간은 일반적인 개발 방식에 비해 대략 10~30% 정도로 늘어난다. 
   - SI 프로젝트에서는 소프트웨어의 품질보다 납기일 준수가 훨씬 중요하기 때문에 TDD 방식을 잘 사용하지 않는다.


## 왜 다들 TDD를 활용하지 못할까? TDD를 하기 여려운 이유는 무엇일까?
1. 개발 시간이 증가한다.
  - 많은 기업들이 단기적인 성과에 집중해 있다.
  - 전체 개발 시간을 줄이는 것보다 오늘 일을 끝내는 것을 강조하기 때문에 TDD 도입이 어렵다.
2. TDD가 어렵다.
  - 이제까지 자신이 개발하던 방식을 많이 바꿔야 하기 때문에 몸에 체득한 것이 많을수록 바꾸기가 어렵다.
  - TDD는 오히려 개발을 별로 안해본 사람에겐 적용하기가 쉽다.
3. TDD는 이렇게 해야된다는 이미지/틀이 있다.
  - ‘반드시 툴(단위 테스트 프레임워크)을 써서 이렇게 해야된다.’라고 생각한다.
  - 하지만 이런 규칙에 얽매이는 것은 애자일이 아니다. 너무 도구/규칙에 집착하니까 TDD가 어려워지는 것이다
  - 결국엔 규칙에 얽매여 똑같은 테스트를 copy&paste 한다.

## TDD를 잘하는 방법
- 적응적, 진화적으로 접근해야 한다.
- 나 스스로 ‘어떻게 해야 피드백을 더 자주 받을까’, ‘어떻게 해야 내가 하는 작업에 대해 협력이 잘 일어나게 할까’를 고민하면서 계속해서 내가 일하는 방식을 업그레이드 해야한다.
- 백도어 접근법: 테스트할 때 어떤 파라미터를 적용하면 내가 원하는 시스템의 시작점으로 가게 하는 것
- 중복적으로 하는 노력들을 조금 더 자동화하도록 업그레이드하면 발전할 수 있다.

## jest
- Jest 는 코드가 제대로 동작하는 지 확인하는 test case 를 만드는 '테스팅 프레임워크'
- 코드가 올바른 기능을 하는 지 체크할 수 있다.

npm test ( 혹은 yarn ) 를 입력하면 jest 커맨드를 실행할 수 있다.
```
{
  "scripts": {
    "test": "jest"
  }
}
```
이를 통해서 보다 안정적이고 제대로 동작하는 코드를 작성할 수 있습니다.





> 출처:  
> https://gmlwjd9405.github.io/2018/06/03/agile-tdd.html  
> https://wooaoe.tistory.com/33
