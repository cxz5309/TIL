# HTTP VS HTTPS

> 이미 아는 내용 먼저 적고 새로 조사한 내용을 추가하자

## HTTP (Hyper Text Transfer Protocol)
#### 알고있는 내용
- 이름 그대로 하이퍼 텍스트로 이루어진 전송 규약
- 전송을 할 때 이런 방식으로 하자 라고 하는 규약으로 표준이 되었다.
- 80번 포트 사용
#### 추가
- HTTP/3부터는 UDP를 사용한다.
## HTTPS 
#### 알고있는 내용
- HTTP에 비해 S 가 추가되었다. S는 SSL(Secure Socket Layer)의 약자로 공인된 인증 사이트에서 발급해주며 SSL을 통해 주고받는 정보를 암호화시킨다.
- http는 패킷이 평문 상태로 오고가기 때문에 해커가 스니핑만 하면 패킷이 그대로 노출될 수 있어 보안에 매우 약하다. 현재 구글에서 주도적으로 HTTPS를 권장하여 통일되어가고 있다. 
- 443 포트 사용
- 공개키 방식의 암호화
  1. 클라이언트가 서버에 인증서 요청 `client hello` [tls버전, 세션 식별자, 암호 설정 등의 정보 제공]
  2. 서버가 클라이언트에 인증서 응답 `server hello` [인증기관에서 발급받은 서버 인증서 = 공개키와 서비스 정보(서버에서 사용하기로 한 tls버전, 세션 식별자, 암호 설정)]
  3. 인증서를 발급한 ca가 자신의 ca리스트에 있는지 확인 -> ca의 해당 공개키를 이용하여 인증서 복호화
  4. 복호화된 인증서와 클라이언트 데이터를 공개키를 이용하여 pre master secret라는 키를 서버로 보낸다.
  5. 서버는 받은 키를 개인키로 복호화하여 master 키로 변환한다.
  6. 통신 준비가 완료되어 master 키를 이용하여 session key를 생성하고 대칭키 방식으로 데이터를 주고받는다.
  7. 클라이언트도 동일한 방식으로 session key를 생성한다.
  8. 클라이언트와 서버가 동일한 세션 키를 가지게 되어 대칭 키 암호를 사용하여 ChangeCipherSpec 메세지를 보낸다.(앞으로의 모든 통신 내용은 세션 키를 사용해 암호화해 보낼 것을 알려준 뒤, Finished 메시지를 보내 각자의 Handshacke 과정이 끝났음을 알림)
#### 추가
- 변조되지 않는 무결성이 존재한다.
- 검색엔진 최적화(SEO)를 위해서도 사용한다. 동일한 키워드 사이에서는 HTTPS 기반 사이트가 상위로 노출된다.
- SSL인증서 종류
  - 싱글 도메인 인증서 : 한 개의 도메인 또는 그 서브도메인
  - 멀티플 도메인 인증서 : 최대 99개까지의 도메인 이름 을 보호함
  - 와일드카드 인증서 : 웹사이트 URL은 물론 서브 도메인도 무제한으로 보호
### https의 단점
- 패킷의 암호화를 성공해서 스니핑의 위험에서는 벗어났으나 역으로 해커가 ssl을 이용하여 클라이언트 공격을 수행한다면 보안 담당자도 확인할 수 없다. 즉 개인정보 유출, ddos, apt, 악성코드, 랜섬웨이 등의 공격은 네트워크 보안장비가 파악할 수 없게 된다. 
- 이것에 대한 해결법으로 패킷을 클라이언트에 들여보내기 전에 복호화하여 정상적인 패킷인지 보안검사를 진행하고 클라이언트 pc로 중개할지를 선택하는 방법이 있다.
