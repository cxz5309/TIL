# 19 프로토타입
- 자바스크립트는 명령형, 함수형, 프로토타입 기반, 객체지향 프로그래밍을 지원하는 멀티 패러다임 프로그래밍 언어이다.
- 자바스크립트는 객체지향 언어가 아니라고 오해를 받는 경우가 있으나 **자바스크립트는 클래스 기반 객체지향 프로그래밍 언어보다 효율적이며 더 강력한 객체지향 프로그래밍 능력을 지니고 있는 프로토타입 기반 객체지향 프로그래밍 언어이다.**
- 자바스크립트를 이루고 있는 **거의 모든것이 객체이다!** 원시 타입의 값을 제외한 나머지 값들은 모두 객체이다.


## 19.1 객체지향 프로그래밍
- 명령형 프로그래밍의 절차지향적 관점에서 벗어나 객체의 집합으로 프로그램을 표현한다!
### 추상화 
- 공통의 속성이나 기능을 묶어 이름을 붙이는 것
- 자바스크립트의 모든 객체는 속성을 가지고 있고 다양한 속성 중에서 프로그램에 필요한 속성만 간추려 내어 표현하는 것을 추상화라고 한다.




## 42.1 동기 처리와 비동기 처리

- 함수를 호출하면 함수 코드가 **평가**되어 함수 **실행 컨텍스트**가 생성된다.
- 함수 실행 컨텍스트는 실행 컨텍스트 스택(콜 스택)에 푸시되고 함수 코드가 실행된다.
- 실행이 종료되면 스택에서 팝되어 제거된다.

- **자바 스크립트 엔진은 단 하나의 실행 컨텍스트 스택을 갖는다.**
- 즉 싱글 스레드 방식으로 동작하고 싱글 스레드 방식은 한 번에 하나의 태스크만 실행할 수 있기 때문에 처리에 시간이 걸리는 태스크를 실행하는 경우 블로킹(중단)이 발생한다.
- 이처럼 현재 실행 중인 태스크가 종료할 때 까지 다음에 실행될 태스크가 대기하는 방식을 **동기 처리**라고 한다. 
- **동기 처리**는 태스크를 순서대로 하나씩 처리하므로 **실행 순서가 보장**되지만 앞선 태스크가 종료할 때까지 **이후 태스크들이 블로킹**되는 단점이 있다.
- **비동기 처리**는 현재 실행중인 태스크가 종료되지 않은 상태라 해도 곧바로 다음 태스크를 실행하는 방식이다.
- **비동기 처리**는 **블로킹이 발생하지 않는다**는 장점이 있지만 **태스크의 실행 순서가 보장되지 않는** 단점이 있다.

## 42.2 이벤트 루프와 태스크 큐
- 자바스크립트에서 동시성을 지원하는 것이 이벤트 루프이다.
### 자바스크립트 엔진
- 크게 두 개의 영역으로 구분할 수 있다.
1. 콜 스택
   - 실행 컨텍스트가 추가되고 제거되는 스택 자료구조이다. 단 하나의 콜 스택이 사용되기 때문에 동기적으로 작동한다.
2. 힙
   - 객체가 저장되는 메모리 공간이다. 객체는 원시값과 달리 크기가 정해져 있지 않기 때문에 힙은 구조화되어 있지 않다.

- 비동기 처리는 **콜 스택이 담당하지 않는다**. 소스코드의 평과와 실행을 제외한 모든 처리는 자바스크립트 엔진을 구동하는 환경이 **브라우저** 또는 **Nodejs**가 담당한다. 이를 위한 브라우저 환경은 **태스크 큐**와 **이벤트 루프**를 제공한다.

## 브라우저 환경
1. 태스크 큐
   - setTimeout, seInterval등의 비동기 함수의 콜백 함수 또는 이벤트 핸들러가 일시적으로 보관되는 영역, 프로미스의 후속 처리 메서드늬 콜백 함수가 일시적으로 보관되는 마이크로태스크 큐도 존재한다.
2. 이벤트 루프
   - 콜 스택에 현재 실행 중인 실행 컨택스트가 있는지, 태스크 큐에 대기중인 함수가 있는지 반복해서 확인하며 콜 스택이 비어 있고 태스크 큐에 대기 중인 함수가 있다면 순차적(FIFO)으로 콜 스택으로 이동시킨다. 이 방법으로 태스크 큐에 보관된 함수들이 비동기 처리 방식으로 동작한다.
- 자바스크립트는 싱글 스레드 방식으로 동작하지만 브라우저는 멀티 스레드로 동작한다.
- 브라우저는 자바스크립트 엔진 외에도 렌더링 엔진과 web api를 제공한다. web api는 dom api와 타이머 함수, http요청 등과 같은 비동기 처리를 포함한다.

